"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const A=require("react");var K={exports:{}},Y={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Se;function pr(){if(Se)return Y;Se=1;var p=A,h=Symbol.for("react.element"),s=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,m=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function i(v,f,x){var _,O={},j=null,P=null;x!==void 0&&(j=""+x),f.key!==void 0&&(j=""+f.key),f.ref!==void 0&&(P=f.ref);for(_ in f)u.call(f,_)&&!c.hasOwnProperty(_)&&(O[_]=f[_]);if(v&&v.defaultProps)for(_ in f=v.defaultProps,f)O[_]===void 0&&(O[_]=f[_]);return{$$typeof:h,type:v,key:j,ref:P,props:O,_owner:m.current}}return Y.Fragment=s,Y.jsx=i,Y.jsxs=i,Y}var L={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var je;function mr(){return je||(je=1,process.env.NODE_ENV!=="production"&&function(){var p=A,h=Symbol.for("react.element"),s=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),v=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),P=Symbol.for("react.offscreen"),I=Symbol.iterator,w="@@iterator";function R(e){if(e===null||typeof e!="object")return null;var r=I&&e[I]||e[w];return typeof r=="function"?r:null}var $=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function E(e){{for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];Fe("error",e,n)}}function Fe(e,r,n){{var t=$.ReactDebugCurrentFrame,l=t.getStackAddendum();l!==""&&(r+="%s",n=n.concat([l]));var d=n.map(function(o){return String(o)});d.unshift("Warning: "+r),Function.prototype.apply.call(console[e],console,d)}}var Ae=!1,$e=!1,Me=!1,Ve=!1,Ie=!1,ne;ne=Symbol.for("react.module.reference");function Ne(e){return!!(typeof e=="string"||typeof e=="function"||e===u||e===c||Ie||e===m||e===x||e===_||Ve||e===P||Ae||$e||Me||typeof e=="object"&&e!==null&&(e.$$typeof===j||e.$$typeof===O||e.$$typeof===i||e.$$typeof===v||e.$$typeof===f||e.$$typeof===ne||e.getModuleId!==void 0))}function We(e,r,n){var t=e.displayName;if(t)return t;var l=r.displayName||r.name||"";return l!==""?n+"("+l+")":n}function te(e){return e.displayName||"Context"}function k(e){if(e==null)return null;if(typeof e.tag=="number"&&E("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case u:return"Fragment";case s:return"Portal";case c:return"Profiler";case m:return"StrictMode";case x:return"Suspense";case _:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case v:var r=e;return te(r)+".Consumer";case i:var n=e;return te(n._context)+".Provider";case f:return We(e,e.render,"ForwardRef");case O:var t=e.displayName||null;return t!==null?t:k(e.type)||"Memo";case j:{var l=e,d=l._payload,o=l._init;try{return k(o(d))}catch{return null}}}return null}var D=Object.assign,N=0,ae,oe,ie,se,ue,ce,le;function fe(){}fe.__reactDisabledLog=!0;function Ye(){{if(N===0){ae=console.log,oe=console.info,ie=console.warn,se=console.error,ue=console.group,ce=console.groupCollapsed,le=console.groupEnd;var e={configurable:!0,enumerable:!0,value:fe,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}N++}}function Le(){{if(N--,N===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:D({},e,{value:ae}),info:D({},e,{value:oe}),warn:D({},e,{value:ie}),error:D({},e,{value:se}),group:D({},e,{value:ue}),groupCollapsed:D({},e,{value:ce}),groupEnd:D({},e,{value:le})})}N<0&&E("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var G=$.ReactCurrentDispatcher,z;function U(e,r,n){{if(z===void 0)try{throw Error()}catch(l){var t=l.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||""}return`
`+z+e}}var X=!1,B;{var Ue=typeof WeakMap=="function"?WeakMap:Map;B=new Ue}function de(e,r){if(!e||X)return"";{var n=B.get(e);if(n!==void 0)return n}var t;X=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var d;d=G.current,G.current=null,Ye();try{if(r){var o=function(){throw Error()};if(Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(T){t=T}Reflect.construct(e,[],o)}else{try{o.call()}catch(T){t=T}e.call(o.prototype)}}else{try{throw Error()}catch(T){t=T}e()}}catch(T){if(T&&t&&typeof T.stack=="string"){for(var a=T.stack.split(`
`),y=t.stack.split(`
`),b=a.length-1,g=y.length-1;b>=1&&g>=0&&a[b]!==y[g];)g--;for(;b>=1&&g>=0;b--,g--)if(a[b]!==y[g]){if(b!==1||g!==1)do if(b--,g--,g<0||a[b]!==y[g]){var S=`
`+a[b].replace(" at new "," at ");return e.displayName&&S.includes("<anonymous>")&&(S=S.replace("<anonymous>",e.displayName)),typeof e=="function"&&B.set(e,S),S}while(b>=1&&g>=0);break}}}finally{X=!1,G.current=d,Le(),Error.prepareStackTrace=l}var V=e?e.displayName||e.name:"",F=V?U(V):"";return typeof e=="function"&&B.set(e,F),F}function Be(e,r,n){return de(e,!1)}function qe(e){var r=e.prototype;return!!(r&&r.isReactComponent)}function q(e,r,n){if(e==null)return"";if(typeof e=="function")return de(e,qe(e));if(typeof e=="string")return U(e);switch(e){case x:return U("Suspense");case _:return U("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case f:return Be(e.render);case O:return q(e.type,r,n);case j:{var t=e,l=t._payload,d=t._init;try{return q(d(l),r,n)}catch{}}}return""}var W=Object.prototype.hasOwnProperty,ve={},pe=$.ReactDebugCurrentFrame;function J(e){if(e){var r=e._owner,n=q(e.type,e._source,r?r.type:null);pe.setExtraStackFrame(n)}else pe.setExtraStackFrame(null)}function Je(e,r,n,t,l){{var d=Function.call.bind(W);for(var o in e)if(d(e,o)){var a=void 0;try{if(typeof e[o]!="function"){var y=Error((t||"React class")+": "+n+" type `"+o+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[o]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw y.name="Invariant Violation",y}a=e[o](r,o,t,n,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(b){a=b}a&&!(a instanceof Error)&&(J(l),E("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",t||"React class",n,o,typeof a),J(null)),a instanceof Error&&!(a.message in ve)&&(ve[a.message]=!0,J(l),E("Failed %s type: %s",n,a.message),J(null))}}}var Ke=Array.isArray;function H(e){return Ke(e)}function Ge(e){{var r=typeof Symbol=="function"&&Symbol.toStringTag,n=r&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n}}function ze(e){try{return me(e),!1}catch{return!0}}function me(e){return""+e}function be(e){if(ze(e))return E("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Ge(e)),me(e)}var ge=$.ReactCurrentOwner,Xe={key:!0,ref:!0,__self:!0,__source:!0},he,_e;function He(e){if(W.call(e,"ref")){var r=Object.getOwnPropertyDescriptor(e,"ref").get;if(r&&r.isReactWarning)return!1}return e.ref!==void 0}function Ze(e){if(W.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function Qe(e,r){typeof e.ref=="string"&&ge.current}function er(e,r){{var n=function(){he||(he=!0,E("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}}function rr(e,r){{var n=function(){_e||(_e=!0,E("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};n.isReactWarning=!0,Object.defineProperty(e,"ref",{get:n,configurable:!0})}}var nr=function(e,r,n,t,l,d,o){var a={$$typeof:h,type:e,key:r,ref:n,props:o,_owner:d};return a._store={},Object.defineProperty(a._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(a,"_self",{configurable:!1,enumerable:!1,writable:!1,value:t}),Object.defineProperty(a,"_source",{configurable:!1,enumerable:!1,writable:!1,value:l}),Object.freeze&&(Object.freeze(a.props),Object.freeze(a)),a};function tr(e,r,n,t,l){{var d,o={},a=null,y=null;n!==void 0&&(be(n),a=""+n),Ze(r)&&(be(r.key),a=""+r.key),He(r)&&(y=r.ref,Qe(r,l));for(d in r)W.call(r,d)&&!Xe.hasOwnProperty(d)&&(o[d]=r[d]);if(e&&e.defaultProps){var b=e.defaultProps;for(d in b)o[d]===void 0&&(o[d]=b[d])}if(a||y){var g=typeof e=="function"?e.displayName||e.name||"Unknown":e;a&&er(o,g),y&&rr(o,g)}return nr(e,a,y,l,t,ge.current,o)}}var Z=$.ReactCurrentOwner,Re=$.ReactDebugCurrentFrame;function M(e){if(e){var r=e._owner,n=q(e.type,e._source,r?r.type:null);Re.setExtraStackFrame(n)}else Re.setExtraStackFrame(null)}var Q;Q=!1;function ee(e){return typeof e=="object"&&e!==null&&e.$$typeof===h}function Ee(){{if(Z.current){var e=k(Z.current.type);if(e)return`

Check the render method of \``+e+"`."}return""}}function ar(e){return""}var ye={};function or(e){{var r=Ee();if(!r){var n=typeof e=="string"?e:e.displayName||e.name;n&&(r=`

Check the top-level render call using <`+n+">.")}return r}}function Te(e,r){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var n=or(r);if(ye[n])return;ye[n]=!0;var t="";e&&e._owner&&e._owner!==Z.current&&(t=" It was passed a child from "+k(e._owner.type)+"."),M(e),E('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',n,t),M(null)}}function Ce(e,r){{if(typeof e!="object")return;if(H(e))for(var n=0;n<e.length;n++){var t=e[n];ee(t)&&Te(t,r)}else if(ee(e))e._store&&(e._store.validated=!0);else if(e){var l=R(e);if(typeof l=="function"&&l!==e.entries)for(var d=l.call(e),o;!(o=d.next()).done;)ee(o.value)&&Te(o.value,r)}}}function ir(e){{var r=e.type;if(r==null||typeof r=="string")return;var n;if(typeof r=="function")n=r.propTypes;else if(typeof r=="object"&&(r.$$typeof===f||r.$$typeof===O))n=r.propTypes;else return;if(n){var t=k(r);Je(n,e.props,"prop",t,e)}else if(r.PropTypes!==void 0&&!Q){Q=!0;var l=k(r);E("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",l||"Unknown")}typeof r.getDefaultProps=="function"&&!r.getDefaultProps.isReactClassApproved&&E("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function sr(e){{for(var r=Object.keys(e.props),n=0;n<r.length;n++){var t=r[n];if(t!=="children"&&t!=="key"){M(e),E("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",t),M(null);break}}e.ref!==null&&(M(e),E("Invalid attribute `ref` supplied to `React.Fragment`."),M(null))}}var Oe={};function we(e,r,n,t,l,d){{var o=Ne(e);if(!o){var a="";(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(a+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var y=ar();y?a+=y:a+=Ee();var b;e===null?b="null":H(e)?b="array":e!==void 0&&e.$$typeof===h?(b="<"+(k(e.type)||"Unknown")+" />",a=" Did you accidentally export a JSX literal instead of a component?"):b=typeof e,E("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",b,a)}var g=tr(e,r,n,l,d);if(g==null)return g;if(o){var S=r.children;if(S!==void 0)if(t)if(H(S)){for(var V=0;V<S.length;V++)Ce(S[V],e);Object.freeze&&Object.freeze(S)}else E("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Ce(S,e)}if(W.call(r,"key")){var F=k(e),T=Object.keys(r).filter(function(vr){return vr!=="key"}),re=T.length>0?"{key: someKey, "+T.join(": ..., ")+": ...}":"{key: someKey}";if(!Oe[F+re]){var dr=T.length>0?"{"+T.join(": ..., ")+": ...}":"{}";E(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,re,F,dr,F),Oe[F+re]=!0}}return e===u?sr(g):ir(g),g}}function ur(e,r,n){return we(e,r,n,!0)}function cr(e,r,n){return we(e,r,n,!1)}var lr=cr,fr=ur;L.Fragment=u,L.jsx=lr,L.jsxs=fr}()),L}var xe;function br(){return xe||(xe=1,process.env.NODE_ENV==="production"?K.exports=pr():K.exports=mr()),K.exports}var C=br();const ke={Transports:"#c6dbef",Résidentiel:"#fdb462",Tertiaire:"#ffed6f",Industrie:"#fb8072",Agriculture:"#b3de69",Déchets:"#bebada",UTCATF:"#d9d9d9",Cultures:"#F7DC6F"},gr=["#FF6B35","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#E17055","#74B9FF"];function De(p,h){const s={sectors:[]};console.log("epciData:",p),console.log("leverPercentages:",h);for(const u of p.sectors){const m=h.sectors.find(v=>v.sector_snbc===u.name);if(!m){console.warn(`Sector "${u.name}" not found in CSV data`);continue}const c=[];let i=0;switch(u.calculation_method){case"difference_repartition":i=hr(u,m,p.region,c);break;case"transposition_directe":i=_r(u,m,p.region,c);break;case"sum_transposition":i=Rr(u,m,p,c);break;case"national_repartition":i=Er(u,m,c);break;default:console.error(`Unknown calculation method: ${u.calculation_method}`)}console.log("levers:",c),c.length>0&&s.sectors.push({name:u.name,total:i,levers:c})}return s}function hr(p,h,s,u){const m=p.value2019-p.target2030;let c=0;for(const i of h.levers){const v=i.regional_percentages[s];if(v===void 0){console.warn(`Region "${s}" not found for lever "${i.name}"`);continue}const f=m*(v/100);u.push({name:i.name,contribution:f,color:i.color||void 0}),c+=f}return c}function _r(p,h,s,u){let m=0;for(const c of h.levers){const i=c.regional_percentages[s];if(i===void 0){console.warn(`Region "${s}" not found for lever "${c.name}"`);continue}const v=p.target2030*(i/100);u.push({name:c.name,contribution:v,color:c.color||void 0}),m+=v}return m}function Rr(p,h,s,u){if(!p.source_sectors)return console.error(`Missing source_sectors for sector "${p.name}"`),0;let m=0;for(const i of p.source_sectors){const v=s.sectors.find(f=>f.name===i);v&&(m+=v.target2030)}let c=0;for(const i of h.levers){const v=i.regional_percentages[s.region];if(v===void 0){console.warn(`Region "${s.region}" not found for lever "${i.name}"`);continue}const f=m*(v/100);u.push({name:i.name,contribution:f,color:i.color||void 0}),c+=f}return c}function Er(p,h,s){const u=p.value2019-p.target2030;let m=0;for(const c of h.levers){const i=Object.values(c.regional_percentages)[0];if(i===void 0){console.warn(`No percentage found for lever "${c.name}"`);continue}const v=u*(i/100);s.push({name:c.name,contribution:v,color:c.color||void 0}),m+=v}return m}const Pe="#74B9FF",yr=({epciData:p,leverPercentages:h,selectedSector:s,selectedLever:u,resetZoom:m,className:c="",style:i={}})=>{const[v,f]=A.useState([]),[x,_]=A.useState("overview"),[O,j]=A.useState(null),P=ke,I=A.useMemo(()=>{try{return j(null),De(p,h)}catch(w){return j(w?.message??"Unknown error"),console.error("Error processing Mondrian data:",w),{sectors:[]}}},[p,h]);return A.useEffect(()=>{if(!s){_("overview"),f([]);return}const w=I.sectors.find(R=>R.name===s);w&&(u?(f([{name:s,value:Math.abs(w.total),realValue:w.total,children:w.levers.map(R=>({name:R.name,value:Math.abs(R.contribution),realValue:R.contribution,sector:s,lever:R.name,contribution:R.contribution,color:R.color||P[s]||Pe,selected:R.name===u}))}]),_("sector")):(f([{name:s,value:Math.abs(w.total),realValue:w.total,children:w.levers.map(R=>({name:R.name,value:Math.abs(R.contribution),realValue:R.contribution,sector:s,lever:R.name,contribution:R.contribution,color:R.color||P[s]||Pe}))}]),_("sector")))},[s,u,I,P]),O?C.jsxs("div",{className:"mondrian-error",children:[C.jsx("h4",{children:"Data processing error"}),C.jsx("p",{children:O}),C.jsx("p",{className:"mondrian-error-hint",children:"Please verify the mapping between EPCI sectors and lever percentages."})]}):C.jsxs("div",{className:`mondrian-treemap mondrian-treemap-container ${c}`,style:i,children:[(x==="sector"||s)&&C.jsxs("div",{className:"mondrian-breadcrumb",children:[C.jsx("span",{className:"mondrian-breadcrumb-item clickable",onClick:()=>{_("overview"),f([]),m?.()},children:"Overview"}),C.jsx("span",{className:"mondrian-breadcrumb-separator",children:"›"}),C.jsx("span",{className:"mondrian-breadcrumb-item",children:s}),u&&C.jsxs(C.Fragment,{children:[C.jsx("span",{className:"mondrian-breadcrumb-separator",children:"›"}),C.jsx("span",{className:"mondrian-breadcrumb-item",children:u})]})]}),C.jsx("div",{children:"Mondrian Treemap"})]})};exports.LEVER_COLORS=gr;exports.MondrianTreemap=yr;exports.SECTOR_COLORS=ke;exports.calculateSNBCData=De;
